---
layout: post
title: '[MFC_1] Hello, MFC!'
date: 2020-06-11
author: Wen Jian
cover: ''
tags: C++ MFC
---

> 从今天开始接触MFC！这几天有在瞎看一些关于MFC的技术博客，感觉挺复杂的样子。为了避免在暑期课程里发懵，赶紧趁着这段时间没什么课自学一下~

# MFC入门

## Windows 消息机制

### 基本概念

- SDK：软件开发工具包（Software Development Kit），一般都是一些被软件工程师用于为特定的软件包、软件框架、硬件平台、操作系统等建立应用软件的开发工具的集合。
- API函数：Windows操作系统提供给应用程序编程的接口（Application Programming Interface）。**Windows 应用程序API函数是通过C语言实现的，所有主要的 Windows 函数都在 Windows.h 头文件中进行了声明。**
- 窗口：emmm...就是我们平时看到的窗口啦~ 窗口是 Windows 应用程序与用户进行交互的接口。利用窗口可以接收用户的输入、以及显示输出。
- 句柄：是 Windows 程序中一个重要的概念，使用也非常频繁。 在 Windows 程序中，有各种各样的资源（窗口、图标、光标、画刷等），系统在创建这些资源时会为它们分配内存，并返回标识这些资源的标识号，这个标识号就是句柄。

#### 消息与消息队列

Windows 程序设计是一种完全不同于传统的 DOS 方式的程序设计方法。（DOS是什么？通俗点来讲就是“小黑窗”程序~）它是一种事件驱动方式的程序设计模式，主要是基于消息的。

每一个 Windows 应用程序开始执行后，系统都会为该程序创建一个消息队列，这个消息队列用来存放该程序创建的窗口的消息。

例如，当用户在窗口中画图的时候，按下鼠标左键，此时，操作系统会感知到这一事件，于是将这个事件包装成一个消息，投递到应用程序的消息队列中，等待应用程序的处理。

然后应用程序通过一个消息循环不断地从消息队列中取出消息，并进行响应。 

在这个处理过程中，操作系统也会给应用程序“发送消息”。所谓“发送消息”，**实际上是操作系统调用程序中一个专门负责处理消息的函数，这个函数称为窗口过程**。

![Windows 消息机制](https://s1.ax1x.com/2020/06/12/tXs2hn.png)

这张图很重要！

#### WinMain 函数

在此前小黑窗时代的程序当中，main 函数是一个程序的主体。而在 MFC 时代，占据这一地位的就是 WinMain 啦。WinMain 是 Windows 程序的入口点函数，与 DOS 程序的入口点函数 main 的作用相同，当 WinMain 函数结束或返回时， Windows 应用程序结束。

### Windows 编程模型

> 注：本节代码均在`VS 2019 C语言`环境下编译运行。我们需要创建的Win32项目在 `VS 2019` 被称为 Windows 桌面向导，源文件的语言为C语言（.c）。

直接上手——

``` c++
#include<windows.h>//底层实现窗口

//程序入口函数

//WINAPI 是宏，代表 __stdcall 参数的传递顺序：从右到左依次入栈，并且在函数返回前清空栈

int WINAPI WinMain(
	HINSTANCE hInstance, //应用程序实例句柄
	HINSTANCE hPrevInstance, //上一个应用程序句柄，在win32环境下，参数一般为NULL，不起作用了
	LPSTR lpCmdLine, //char * argv[] 命令行参数
	int nShowCmd) //显示命令 最大化、最小化、正常......
{
	/*
	创建窗口的步骤：
	1、设计窗口；
	2、注册窗口；
	3、创建窗口；
	4、显示和更新；
	5、通过循环取消息；
	6、处理消息（窗口过程）；
	*/

	return 0;
}
```

呀！不早啦，明天再来继续学习创建窗口的具体步骤~
